# Ticket Breakdown

We are a staffing company whose primary purpose is to book Agents at Shifts posted by Facilities on our platform. We're working on a new feature which will generate reports for our client Facilities containing info on how many hours each Agent worked in a given quarter by summing up every Shift they worked. Currently, this is how the process works:

- Data is saved in the database in the Facilities, Agents, and Shifts tables
- A function `getShiftsByFacility` is called with the Facility's id, returning all Shifts worked that quarter, including some metadata about the Agent assigned to each
- A function `generateReport` is then called with the list of Shifts. It converts them into a PDF which can be submitted by the Facility for compliance.

## You've been asked to work on a ticket. It reads:

**Currently, the id of each Agent on the reports we generate is their internal database id. We'd like to add the ability for Facilities to save their own custom ids for each Agent they work with and use that id when generating reports for them.**

Based on the information given, break this ticket down into 2-5 individual tickets to perform. Provide as much detail for each ticket as you can, including acceptance criteria, time/effort estimates, and implementation details. Feel free to make informed guesses about any unknown details - you can't guess "wrong".

You will be graded on the level of detail in each ticket, the clarity of the execution plan within and between tickets, and the intelligibility of your language. You don't need to be a native English speaker, but please proof-read your work.

## Your Breakdown Here

# Ticket breakdown: Update Agent ID in Reports

This is a breakdown of the requirements for updating the Agent ID in reports generated by our staffing company's platform. The current reports use the internal database ID of Agents, but we want to give Facilities the ability to save custom IDs for Agents they work with and use these IDs in generated reports.

# Ticket 1: Add custom ID field to Agent table

### Effort: 4 Story Points

## Description

Add a new custom ID field to the Agent table in the database.

## Acceptance Criteria

- A new column "custom_id" is added to the Agent table.
- The "custom_id" field can accept alphanumeric characters and can be nullable.
- A migration script is created to add the "custom_id" column to the Agent table.

## Implementation details

- Create a migration script using knex.js to add the "custom_id" column to the Agent table.
- Add validation to the API to ensure that the "custom_id" field is alphanumeric and unique per Facility.
- Add a new field to the Agent model and map it to the "custom_id" column in the database.

# Ticket 2: Update getShiftsByFacility to return custom IDs

### Effort: 3 Story Points

## Description

Update the getShiftsByFacility function to return custom IDs for Agents instead of the internal database ID.

## Acceptance Criteria

- The getShiftsByFacility function now returns the custom ID for each Agent instead of the internal database ID.
- If a custom ID is not set for an Agent, the function returns the internal database ID.

## Implementation details

- Update the SQL query to join the Agent table to the Facility table and return the "custom_id" field.
- Update the function to map the "custom_id" field to the Agent object.

## Ticket 3: Update generateReport to use custom IDs

### Effort: 5 Story Points

## Description

- Update the generateReport function to use custom IDs for Agents when generating reports for Facilities.

## Acceptance Criteria

- The generateReport function now uses the custom ID for each Agent instead of the internal database ID.
- If a custom ID is not set for an Agent, the function uses the internal database ID.

## Implementation details

- Update the API to include a new query parameter useCustomIds which is set to true by default.
- Update the PDF generation library to use the custom ID if useCustomIds is set to true.
- Add tests to ensure that the custom ID is used when useCustomIds is true.

## Ticket 4: Update UI to allow custom ID input

### Effort: 6 Story Points

## Description

- Update the UI to allow Facilities to input custom IDs for each Agent they work with.

## Acceptance Criteria

- A new field for custom ID is added to the Agent form in the UI.
- The form can save custom IDs for Agents.
- The form can display custom IDs for Agents.

## Implementation details

- Add a new input field for custom IDs to the Agent form.
- Update the Agent form component to submit the custom ID with the form data.
- Update the Agent list component to display the custom ID if available.

## Ticket 5: Update API to save custom IDs

### Effort: 2 Story Points

## Description

- Update the API to allow Facilities to save custom IDs for Agents they work with.

## Acceptance Criteria

- The API now accepts a custom ID field when creating or updating Agents.
- Custom IDs are saved to the database.

## Implementation details

- Update the validation to ensure that the custom ID field is alphanumeric and unique per Facility.
